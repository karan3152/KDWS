{% extends "dashboard_layout.html" %}

{% block title %}Forms & Documents - Employee Dashboard{% endblock %}

{% block dashboard_title %}Forms & Documents{% endblock %}

{% block additional_css %}
{{ super() }}
<style>
    .pdf-preview {
        min-height: 200px;
        background-color: #f7fafc;
        border: 1px solid #e2e8f0;
        border-radius: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-top: 1rem;
    }
    
    .document-card {
        margin-bottom: 20px;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .document-card .card-header {
        padding: 12px 15px;
        font-weight: 600;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .document-status {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .document-type-table {
        margin-bottom: 30px;
    }
    
    .document-type-table .table {
        border-collapse: separate;
        border-spacing: 0;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    .document-type-table th {
        background-color: #2C5282;
        color: white;
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.85rem;
        letter-spacing: 0.05em;
    }
    
    .document-upload-button {
        background-color: #48BB78;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 8px 16px;
        font-weight: 600;
        transition: all 0.2s;
    }
    
    .document-upload-button:hover {
        background-color: #38A169;
        transform: translateY(-1px);
    }
    
    .document-progress {
        height: 8px;
        border-radius: 4px;
        margin-top: 25px;
        margin-bottom: 5px;
    }
    
    .document-progress-text {
        display: flex;
        justify-content: space-between;
        font-size: 0.85rem;
        color: #4A5568;
    }
</style>
{% endblock %}

{% block dashboard_content %}
<div class="row mb-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Document Completion Status</h5>
                <div class="progress document-progress">
                    <div class="progress-bar bg-success" role="progressbar" style="width: {{ completion_percentage }}%;" 
                         aria-valuenow="{{ completion_percentage }}" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <div class="document-progress-text">
                    <span>{{ completion_percentage }}% completed</span>
                    <span>{{ missing_docs|length }} documents remaining</span>
                </div>
                
                {% if missing_docs %}
                <div class="alert alert-warning mt-3">
                    <h6 class="alert-heading">Required Documents Missing</h6>
                    <p>Please upload the following required documents:</p>
                    <ul class="mb-0">
                        {% for doc_type in missing_docs %}
                        <li>{{ doc_type|replace('_', ' ')|title }}</li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Identity Documents Section -->
<div class="document-type-table">
    <h4>Identity Documents</h4>
    
    <!-- Aadhar Card Table -->
    <table class="table table-bordered">
        <thead>
            <tr>
                <th colspan="2" class="bg-primary text-white">Aadhar Card</th>
            </tr>
        </thead>
        <tbody>
            {% if documents.aadhar %}
            <tr>
                <td>
                    <div class="font-weight-bold">{{ documents.aadhar.document_name }}</div>
                    <div class="small text-muted">Uploaded on {{ documents.aadhar.upload_date.strftime('%d %b, %Y') }}</div>
                    <div class="mt-2">
                        <strong>Aadhar Number:</strong> {{ documents.aadhar.document_number }}
                    </div>
                    <div class="mt-2">
                        <span class="badge {% if documents.aadhar.status == 'pending' %}badge-warning{% elif documents.aadhar.status == 'approved' %}badge-success{% else %}badge-danger{% endif %}">
                            {{ documents.aadhar.status|title }}
                        </span>
                        <a href="{{ url_for('view_document', document_id=documents.aadhar.id) }}" class="btn btn-sm btn-primary ml-2">
                            View Document
                        </a>
                    </div>
                </td>
                <td class="text-center" style="width: 200px; vertical-align: middle;">
                    <form method="POST" action="{{ url_for('upload_aadhar') }}" enctype="multipart/form-data">
                        {{ aadhar_form.hidden_tag() }}
                        <button type="button" class="btn document-upload-button" onclick="document.getElementById('aadhar_file').click();">
                            Replace Document
                        </button>
                        {{ aadhar_form.document_file(id="aadhar_file", class="d-none", onchange="this.form.submit()") }}
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="2">
                    <div class="py-4 text-center">
                        <form method="POST" action="{{ url_for('upload_aadhar') }}" enctype="multipart/form-data" class="upload-form">
                            {{ aadhar_form.hidden_tag() }}
                            
                            <div class="form-group">
                                <label>Aadhar Number</label>
                                {{ aadhar_form.document_number(class="form-control", placeholder="Enter 12 digit Aadhar number") }}
                            </div>
                            
                            <div class="upload-placeholder mb-3">
                                <i class="fas fa-id-card fa-3x text-primary mb-3"></i>
                                <p>Upload your Aadhar card in PDF or image format</p>
                                <button type="button" class="btn document-upload-button" onclick="document.getElementById('aadhar_file').click();">
                                    Select Document
                                </button>
                                {{ aadhar_form.document_file(id="aadhar_file", class="d-none", onchange="showFileName(this, 'aadhar_filename')") }}
                                <p id="aadhar_filename" class="mt-2 file-name"></p>
                            </div>
                            
                            <button type="submit" class="btn btn-primary">Upload Aadhar</button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
    
    <!-- PAN Card Table -->
    <table class="table table-bordered">
        <thead>
            <tr>
                <th colspan="2" class="bg-primary text-white">PAN Card</th>
            </tr>
        </thead>
        <tbody>
            {% if documents.pan %}
            <tr>
                <td>
                    <div class="font-weight-bold">{{ documents.pan.document_name }}</div>
                    <div class="small text-muted">Uploaded on {{ documents.pan.upload_date.strftime('%d %b, %Y') }}</div>
                    <div class="mt-2">
                        <strong>PAN Number:</strong> {{ documents.pan.document_number }}
                    </div>
                    <div class="mt-2">
                        <span class="badge {% if documents.pan.status == 'pending' %}badge-warning{% elif documents.pan.status == 'approved' %}badge-success{% else %}badge-danger{% endif %}">
                            {{ documents.pan.status|title }}
                        </span>
                        <a href="{{ url_for('view_document', document_id=documents.pan.id) }}" class="btn btn-sm btn-primary ml-2">
                            View Document
                        </a>
                    </div>
                </td>
                <td class="text-center" style="width: 200px; vertical-align: middle;">
                    <form method="POST" action="{{ url_for('upload_pan') }}" enctype="multipart/form-data">
                        {{ pan_form.hidden_tag() }}
                        <button type="button" class="btn document-upload-button" onclick="document.getElementById('pan_file').click();">
                            Replace Document
                        </button>
                        {{ pan_form.document_file(id="pan_file", class="d-none", onchange="this.form.submit()") }}
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="2">
                    <div class="py-4 text-center">
                        <form method="POST" action="{{ url_for('upload_pan') }}" enctype="multipart/form-data" class="upload-form">
                            {{ pan_form.hidden_tag() }}
                            
                            <div class="form-group">
                                <label>PAN Number</label>
                                {{ pan_form.document_number(class="form-control", placeholder="Enter 10 character PAN number") }}
                            </div>
                            
                            <div class="upload-placeholder mb-3">
                                <i class="fas fa-id-card fa-3x text-primary mb-3"></i>
                                <p>Upload your PAN card in PDF or image format</p>
                                <button type="button" class="btn document-upload-button" onclick="document.getElementById('pan_file').click();">
                                    Select Document
                                </button>
                                {{ pan_form.document_file(id="pan_file", class="d-none", onchange="showFileName(this, 'pan_filename')") }}
                                <p id="pan_filename" class="mt-2 file-name"></p>
                            </div>
                            
                            <button type="submit" class="btn btn-primary">Upload PAN</button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
    
    <!-- Photo Table -->
    <table class="table table-bordered">
        <thead>
            <tr>
                <th colspan="2" class="bg-primary text-white">Passport Size Photo</th>
            </tr>
        </thead>
        <tbody>
            {% if documents.photo %}
            <tr>
                <td>
                    <div class="font-weight-bold">{{ documents.photo.document_name }}</div>
                    <div class="small text-muted">Uploaded on {{ documents.photo.upload_date.strftime('%d %b, %Y') }}</div>
                    <div class="mt-2">
                        <span class="badge {% if documents.photo.status == 'pending' %}badge-warning{% elif documents.photo.status == 'approved' %}badge-success{% else %}badge-danger{% endif %}">
                            {{ documents.photo.status|title }}
                        </span>
                        <a href="{{ url_for('view_document', document_id=documents.photo.id) }}" class="btn btn-sm btn-primary ml-2">
                            View Photo
                        </a>
                    </div>
                </td>
                <td class="text-center" style="width: 200px; vertical-align: middle;">
                    <form method="POST" action="{{ url_for('upload_photo') }}" enctype="multipart/form-data">
                        {{ photo_form.hidden_tag() }}
                        <button type="button" class="btn document-upload-button" onclick="document.getElementById('photo_file').click();">
                            Replace Photo
                        </button>
                        {{ photo_form.document_file(id="photo_file", class="d-none", onchange="this.form.submit()") }}
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="2">
                    <div class="py-4 text-center">
                        <form method="POST" action="{{ url_for('upload_photo') }}" enctype="multipart/form-data" class="upload-form">
                            {{ photo_form.hidden_tag() }}
                            
                            <div class="upload-placeholder mb-3">
                                <i class="fas fa-user fa-3x text-primary mb-3"></i>
                                <p>Upload a passport size photo (JPG, PNG formats only)</p>
                                <button type="button" class="btn document-upload-button" onclick="document.getElementById('photo_file').click();">
                                    Select Photo
                                </button>
                                {{ photo_form.document_file(id="photo_file", class="d-none", onchange="showFileName(this, 'photo_filename')") }}
                                <p id="photo_filename" class="mt-2 file-name"></p>
                            </div>
                            
                            <button type="submit" class="btn btn-primary">Upload Photo</button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>

<!-- Bank Details Section -->
<div class="document-type-table">
    <h4>Bank Details</h4>
    
    <!-- Bank Passbook Table -->
    <table class="table table-bordered">
        <thead>
            <tr>
                <th colspan="2" class="bg-primary text-white">Bank Passbook</th>
            </tr>
        </thead>
        <tbody>
            {% if documents.passbook %}
            <tr>
                <td>
                    <div class="font-weight-bold">{{ documents.passbook.document_name }}</div>
                    <div class="small text-muted">Uploaded on {{ documents.passbook.upload_date.strftime('%d %b, %Y') }}</div>
                    <div class="mt-2">
                        <strong>Account Number:</strong> {{ documents.passbook.document_number }}<br>
                        <strong>Bank Name:</strong> {{ documents.passbook.bank_name }}<br>
                        <strong>IFSC Code:</strong> {{ documents.passbook.ifsc_code }}
                    </div>
                    <div class="mt-2">
                        <span class="badge {% if documents.passbook.status == 'pending' %}badge-warning{% elif documents.passbook.status == 'approved' %}badge-success{% else %}badge-danger{% endif %}">
                            {{ documents.passbook.status|title }}
                        </span>
                        <a href="{{ url_for('view_document', document_id=documents.passbook.id) }}" class="btn btn-sm btn-primary ml-2">
                            View Passbook
                        </a>
                    </div>
                </td>
                <td class="text-center" style="width: 200px; vertical-align: middle;">
                    <form method="POST" action="{{ url_for('upload_passbook') }}" enctype="multipart/form-data">
                        {{ passbook_form.hidden_tag() }}
                        <button type="button" class="btn document-upload-button" onclick="document.getElementById('passbook_file').click();">
                            Replace Document
                        </button>
                        {{ passbook_form.document_file(id="passbook_file", class="d-none", onchange="this.form.submit()") }}
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="2">
                    <div class="py-4 text-center">
                        <form method="POST" action="{{ url_for('upload_passbook') }}" enctype="multipart/form-data" class="upload-form">
                            {{ passbook_form.hidden_tag() }}
                            
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Account Number</label>
                                        {{ passbook_form.document_number(class="form-control", placeholder="Enter your account number") }}
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Bank Name</label>
                                        {{ passbook_form.bank_name(class="form-control", placeholder="Bank name") }}
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>IFSC Code</label>
                                        {{ passbook_form.ifsc_code(class="form-control", placeholder="IFSC code") }}
                                    </div>
                                </div>
                            </div>
                            
                            <div class="upload-placeholder mb-3">
                                <i class="fas fa-university fa-3x text-primary mb-3"></i>
                                <p>Upload the first page of your passbook or a cancelled cheque</p>
                                <button type="button" class="btn document-upload-button" onclick="document.getElementById('passbook_file').click();">
                                    Select Document
                                </button>
                                {{ passbook_form.document_file(id="passbook_file", class="d-none", onchange="showFileName(this, 'passbook_filename')") }}
                                <p id="passbook_filename" class="mt-2 file-name"></p>
                            </div>
                            
                            <button type="submit" class="btn btn-primary">Upload Passbook</button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>

<!-- PF Forms Section -->
<div class="document-type-table">
    <h4>PF Forms</h4>
    
    <!-- Joining Form Table -->
    <table class="table table-bordered">
        <thead>
            <tr>
                <th colspan="2" class="bg-primary text-white">Joining Application Form</th>
            </tr>
        </thead>
        <tbody>
            {% if documents.joining_form %}
            <tr>
                <td>
                    <div class="font-weight-bold">{{ documents.joining_form.document_name }}</div>
                    <div class="small text-muted">Uploaded on {{ documents.joining_form.upload_date.strftime('%d %b, %Y') }}</div>
                    <div class="mt-2">
                        <span class="badge {% if documents.joining_form.status == 'pending' %}badge-warning{% elif documents.joining_form.status == 'approved' %}badge-success{% else %}badge-danger{% endif %}">
                            {{ documents.joining_form.status|title }}
                        </span>
                        <a href="{{ url_for('view_document', document_id=documents.joining_form.id) }}" class="btn btn-sm btn-primary ml-2">
                            View Document
                        </a>
                    </div>
                </td>
                <td class="text-center" style="width: 200px; vertical-align: middle;">
                    <form method="POST" action="{{ url_for('upload_joining_form') }}" enctype="multipart/form-data">
                        {{ joining_form.hidden_tag() }}
                        <button type="button" class="btn document-upload-button" onclick="document.getElementById('joining_form_file').click();">
                            Replace Document
                        </button>
                        {{ joining_form.document_file(id="joining_form_file", class="d-none", onchange="this.form.submit()") }}
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="2">
                    <div class="py-4 text-center">
                        <form method="POST" action="{{ url_for('upload_joining_form') }}" enctype="multipart/form-data" class="upload-form">
                            {{ joining_form.hidden_tag() }}
                            
                            <div class="upload-placeholder mb-3">
                                <i class="fas fa-file-pdf fa-3x text-primary mb-3"></i>
                                <p>Upload your completed Joining Application Form</p>
                                <a href="{{ url_for('static', filename='forms/1 New Joining Application.pdf') }}" class="btn btn-outline-secondary mb-3" target="_blank">
                                    Download Blank Form
                                </a>
                                <button type="button" class="btn document-upload-button d-block mx-auto" onclick="document.getElementById('joining_form_file').click();">
                                    Select Completed Form
                                </button>
                                {{ joining_form.document_file(id="joining_form_file", class="d-none", onchange="showFileName(this, 'joining_form_filename')") }}
                                <p id="joining_form_filename" class="mt-2 file-name"></p>
                            </div>
                            
                            <button type="submit" class="btn btn-primary">Upload Form</button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
    
    <!-- PF Form Table -->
    <table class="table table-bordered">
        <thead>
            <tr>
                <th colspan="2" class="bg-primary text-white">PF Form 2</th>
            </tr>
        </thead>
        <tbody>
            {% if documents.pf_form %}
            <tr>
                <td>
                    <div class="font-weight-bold">{{ documents.pf_form.document_name }}</div>
                    <div class="small text-muted">Uploaded on {{ documents.pf_form.upload_date.strftime('%d %b, %Y') }}</div>
                    <div class="mt-2">
                        <span class="badge {% if documents.pf_form.status == 'pending' %}badge-warning{% elif documents.pf_form.status == 'approved' %}badge-success{% else %}badge-danger{% endif %}">
                            {{ documents.pf_form.status|title }}
                        </span>
                        <a href="{{ url_for('view_document', document_id=documents.pf_form.id) }}" class="btn btn-sm btn-primary ml-2">
                            View Document
                        </a>
                    </div>
                </td>
                <td class="text-center" style="width: 200px; vertical-align: middle;">
                    <form method="POST" action="{{ url_for('upload_pf_form') }}" enctype="multipart/form-data">
                        {{ pf_form.hidden_tag() }}
                        <button type="button" class="btn document-upload-button" onclick="document.getElementById('pf_form_file').click();">
                            Replace Document
                        </button>
                        {{ pf_form.document_file(id="pf_form_file", class="d-none", onchange="this.form.submit()") }}
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="2">
                    <div class="py-4 text-center">
                        <form method="POST" action="{{ url_for('upload_pf_form') }}" enctype="multipart/form-data" class="upload-form">
                            {{ pf_form.hidden_tag() }}
                            
                            <div class="upload-placeholder mb-3">
                                <i class="fas fa-file-pdf fa-3x text-primary mb-3"></i>
                                <p>Upload your completed PF Form 2</p>
                                <a href="{{ url_for('static', filename='forms/2 PF From 2 Revised.pdf') }}" class="btn btn-outline-secondary mb-3" target="_blank">
                                    Download Blank Form
                                </a>
                                <button type="button" class="btn document-upload-button d-block mx-auto" onclick="document.getElementById('pf_form_file').click();">
                                    Select Completed Form
                                </button>
                                {{ pf_form.document_file(id="pf_form_file", class="d-none", onchange="showFileName(this, 'pf_form_filename')") }}
                                <p id="pf_form_filename" class="mt-2 file-name"></p>
                            </div>
                            
                            <button type="submit" class="btn btn-primary">Upload Form</button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
    
    <!-- Form 1 Table -->
    <table class="table table-bordered">
        <thead>
            <tr>
                <th colspan="2" class="bg-primary text-white">Form 1 - Nomination & Declaration Form</th>
            </tr>
        </thead>
        <tbody>
            {% if documents.form1 %}
            <tr>
                <td>
                    <div class="font-weight-bold">{{ documents.form1.document_name }}</div>
                    <div class="small text-muted">Uploaded on {{ documents.form1.upload_date.strftime('%d %b, %Y') }}</div>
                    <div class="mt-2">
                        <span class="badge {% if documents.form1.status == 'pending' %}badge-warning{% elif documents.form1.status == 'approved' %}badge-success{% else %}badge-danger{% endif %}">
                            {{ documents.form1.status|title }}
                        </span>
                        <a href="{{ url_for('view_document', document_id=documents.form1.id) }}" class="btn btn-sm btn-primary ml-2">
                            View Document
                        </a>
                    </div>
                </td>
                <td class="text-center" style="width: 200px; vertical-align: middle;">
                    <form method="POST" action="{{ url_for('upload_form1') }}" enctype="multipart/form-data">
                        {{ form1_form.hidden_tag() }}
                        <button type="button" class="btn document-upload-button" onclick="document.getElementById('form1_file').click();">
                            Replace Document
                        </button>
                        {{ form1_form.document_file(id="form1_file", class="d-none", onchange="this.form.submit()") }}
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="2">
                    <div class="py-4 text-center">
                        <form method="POST" action="{{ url_for('upload_form1') }}" enctype="multipart/form-data" class="upload-form">
                            {{ form1_form.hidden_tag() }}
                            
                            <div class="upload-placeholder mb-3">
                                <i class="fas fa-file-pdf fa-3x text-primary mb-3"></i>
                                <p>Upload your completed Form 1 - Nomination & Declaration Form</p>
                                <a href="{{ url_for('static', filename='forms/3 Form 1 Nomination & Declaration Form.pdf') }}" class="btn btn-outline-secondary mb-3" target="_blank">
                                    Download Blank Form
                                </a>
                                <button type="button" class="btn document-upload-button d-block mx-auto" onclick="document.getElementById('form1_file').click();">
                                    Select Completed Form
                                </button>
                                {{ form1_form.document_file(id="form1_file", class="d-none", onchange="showFileName(this, 'form1_filename')") }}
                                <p id="form1_filename" class="mt-2 file-name"></p>
                            </div>
                            
                            <button type="submit" class="btn btn-primary">Upload Form</button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
    
    <!-- Form 11 Table -->
    <table class="table table-bordered">
        <thead>
            <tr>
                <th colspan="2" class="bg-primary text-white">Form 11</th>
            </tr>
        </thead>
        <tbody>
            {% if documents.form11 %}
            <tr>
                <td>
                    <div class="font-weight-bold">{{ documents.form11.document_name }}</div>
                    <div class="small text-muted">Uploaded on {{ documents.form11.upload_date.strftime('%d %b, %Y') }}</div>
                    <div class="mt-2">
                        <span class="badge {% if documents.form11.status == 'pending' %}badge-warning{% elif documents.form11.status == 'approved' %}badge-success{% else %}badge-danger{% endif %}">
                            {{ documents.form11.status|title }}
                        </span>
                        <a href="{{ url_for('view_document', document_id=documents.form11.id) }}" class="btn btn-sm btn-primary ml-2">
                            View Document
                        </a>
                    </div>
                </td>
                <td class="text-center" style="width: 200px; vertical-align: middle;">
                    <form method="POST" action="{{ url_for('upload_form11') }}" enctype="multipart/form-data">
                        {{ form11_form.hidden_tag() }}
                        <button type="button" class="btn document-upload-button" onclick="document.getElementById('form11_file').click();">
                            Replace Document
                        </button>
                        {{ form11_form.document_file(id="form11_file", class="d-none", onchange="this.form.submit()") }}
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="2">
                    <div class="py-4 text-center">
                        <form method="POST" action="{{ url_for('upload_form11') }}" enctype="multipart/form-data" class="upload-form">
                            {{ form11_form.hidden_tag() }}
                            
                            <div class="upload-placeholder mb-3">
                                <i class="fas fa-file-pdf fa-3x text-primary mb-3"></i>
                                <p>Upload your completed Form 11</p>
                                <a href="{{ url_for('static', filename='forms/4 Form11Revised.pdf') }}" class="btn btn-outline-secondary mb-3" target="_blank">
                                    Download Blank Form
                                </a>
                                <button type="button" class="btn document-upload-button d-block mx-auto" onclick="document.getElementById('form11_file').click();">
                                    Select Completed Form
                                </button>
                                {{ form11_form.document_file(id="form11_file", class="d-none", onchange="showFileName(this, 'form11_filename')") }}
                                <p id="form11_filename" class="mt-2 file-name"></p>
                            </div>
                            
                            <button type="submit" class="btn btn-primary">Upload Form</button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
    
    <!-- Police Verification Certificate Table -->
    <table class="table table-bordered">
        <thead>
            <tr>
                <th colspan="2" class="bg-success text-white">Police Verification Certificate</th>
            </tr>
        </thead>
        <tbody>
            {% if documents.police_verification %}
            <tr>
                <td>
                    <div class="font-weight-bold">{{ documents.police_verification.document_name }}</div>
                    <div class="small text-muted">Uploaded on {{ documents.police_verification.upload_date.strftime('%d %b, %Y') }}</div>
                    {% if documents.police_verification.issue_date %}
                    <div class="small text-muted">Issued on {{ documents.police_verification.issue_date.strftime('%d %b, %Y') }}</div>
                    {% endif %}
                    {% if documents.police_verification.document_number %}
                    <div class="small text-muted">Certificate Number: {{ documents.police_verification.document_number }}</div>
                    {% endif %}
                    <div class="mt-2">
                        <span class="badge {% if documents.police_verification.status == 'pending' %}badge-warning{% elif documents.police_verification.status == 'approved' %}badge-success{% else %}badge-danger{% endif %}">
                            {{ documents.police_verification.status|title }}
                        </span>
                        <a href="{{ url_for('view_document', document_id=documents.police_verification.id) }}" class="btn btn-sm btn-primary ml-2">
                            View Document
                        </a>
                    </div>
                </td>
                <td class="text-center" style="width: 200px; vertical-align: middle;">
                    <form method="POST" action="{{ url_for('upload_police_verification') }}" enctype="multipart/form-data">
                        {{ police_verification_form.hidden_tag() }}
                        <button type="button" class="btn document-upload-button" onclick="document.getElementById('police_verification_file').click();">
                            Replace Document
                        </button>
                        {{ police_verification_form.document_file(id="police_verification_file", class="d-none", onchange="this.form.submit()") }}
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="2">
                    <div class="py-4 text-center">
                        <form method="POST" action="{{ url_for('upload_police_verification') }}" enctype="multipart/form-data" class="upload-form">
                            {{ police_verification_form.hidden_tag() }}
                            
                            <div class="upload-placeholder mb-3">
                                <i class="fas fa-file-pdf fa-3x text-success mb-3"></i>
                                <p>Upload your Police Verification Certificate</p>
                                <button type="button" class="btn document-upload-button d-block mx-auto" onclick="document.getElementById('police_verification_file').click();">
                                    Select Document
                                </button>
                                {{ police_verification_form.document_file(id="police_verification_file", class="d-none", onchange="showFileName(this, 'police_verification_filename')") }}
                                <p id="police_verification_filename" class="mt-2 file-name"></p>
                            </div>
                            
                            <div class="form-row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        {{ police_verification_form.document_number.label }}
                                        {{ police_verification_form.document_number(class="form-control") }}
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        {{ police_verification_form.issue_date.label }}
                                        {{ police_verification_form.issue_date(class="form-control", type="date") }}
                                    </div>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-success">Upload Certificate</button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
    
    <!-- Medical Certificate Table -->
    <table class="table table-bordered">
        <thead>
            <tr>
                <th colspan="2" class="bg-success text-white">Medical Certificate</th>
            </tr>
        </thead>
        <tbody>
            {% if documents.medical_certificate %}
            <tr>
                <td>
                    <div class="font-weight-bold">{{ documents.medical_certificate.document_name }}</div>
                    <div class="small text-muted">Uploaded on {{ documents.medical_certificate.upload_date.strftime('%d %b, %Y') }}</div>
                    {% if documents.medical_certificate.issue_date %}
                    <div class="small text-muted">Issued on {{ documents.medical_certificate.issue_date.strftime('%d %b, %Y') }}</div>
                    {% endif %}
                    {% if documents.medical_certificate.expiry_date %}
                    <div class="small text-muted">Valid until {{ documents.medical_certificate.expiry_date.strftime('%d %b, %Y') }}</div>
                    {% endif %}
                    <div class="mt-2">
                        <span class="badge {% if documents.medical_certificate.status == 'pending' %}badge-warning{% elif documents.medical_certificate.status == 'approved' %}badge-success{% else %}badge-danger{% endif %}">
                            {{ documents.medical_certificate.status|title }}
                        </span>
                        <a href="{{ url_for('view_document', document_id=documents.medical_certificate.id) }}" class="btn btn-sm btn-primary ml-2">
                            View Document
                        </a>
                    </div>
                </td>
                <td class="text-center" style="width: 200px; vertical-align: middle;">
                    <form method="POST" action="{{ url_for('upload_medical_certificate') }}" enctype="multipart/form-data">
                        {{ medical_certificate_form.hidden_tag() }}
                        <button type="button" class="btn document-upload-button" onclick="document.getElementById('medical_certificate_file').click();">
                            Replace Document
                        </button>
                        {{ medical_certificate_form.document_file(id="medical_certificate_file", class="d-none", onchange="this.form.submit()") }}
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="2">
                    <div class="py-4 text-center">
                        <form method="POST" action="{{ url_for('upload_medical_certificate') }}" enctype="multipart/form-data" class="upload-form">
                            {{ medical_certificate_form.hidden_tag() }}
                            
                            <div class="upload-placeholder mb-3">
                                <i class="fas fa-file-medical fa-3x text-success mb-3"></i>
                                <p>Upload your Medical Certificate</p>
                                <button type="button" class="btn document-upload-button d-block mx-auto" onclick="document.getElementById('medical_certificate_file').click();">
                                    Select Document
                                </button>
                                {{ medical_certificate_form.document_file(id="medical_certificate_file", class="d-none", onchange="showFileName(this, 'medical_certificate_filename')") }}
                                <p id="medical_certificate_filename" class="mt-2 file-name"></p>
                            </div>
                            
                            <div class="form-row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        {{ medical_certificate_form.issue_date.label }}
                                        {{ medical_certificate_form.issue_date(class="form-control", type="date") }}
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        {{ medical_certificate_form.expiry_date.label }}
                                        {{ medical_certificate_form.expiry_date(class="form-control", type="date") }}
                                    </div>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-success">Upload Certificate</button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
    
    <!-- Family Details Document Table -->
    <table class="table table-bordered">
        <thead>
            <tr>
                <th colspan="2" class="bg-info text-white">Family Details Document</th>
            </tr>
        </thead>
        <tbody>
            {% if documents.family_details %}
            <tr>
                <td>
                    <div class="font-weight-bold">{{ documents.family_details.document_name }}</div>
                    <div class="small text-muted">Uploaded on {{ documents.family_details.upload_date.strftime('%d %b, %Y') }}</div>
                    <div class="mt-2">
                        <span class="badge {% if documents.family_details.status == 'pending' %}badge-warning{% elif documents.family_details.status == 'approved' %}badge-success{% else %}badge-danger{% endif %}">
                            {{ documents.family_details.status|title }}
                        </span>
                        <a href="{{ url_for('view_document', document_id=documents.family_details.id) }}" class="btn btn-sm btn-primary ml-2">
                            View Document
                        </a>
                    </div>
                </td>
                <td class="text-center" style="width: 200px; vertical-align: middle;">
                    <form method="POST" action="{{ url_for('upload_family_details') }}" enctype="multipart/form-data">
                        {{ family_details_form.hidden_tag() }}
                        <button type="button" class="btn document-upload-button" onclick="document.getElementById('family_details_file').click();">
                            Replace Document
                        </button>
                        {{ family_details_form.document_file(id="family_details_file", class="d-none", onchange="this.form.submit()") }}
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="2">
                    <div class="py-4 text-center">
                        <form method="POST" action="{{ url_for('upload_family_details') }}" enctype="multipart/form-data" class="upload-form">
                            {{ family_details_form.hidden_tag() }}
                            
                            <div class="upload-placeholder mb-3">
                                <i class="fas fa-users fa-3x text-info mb-3"></i>
                                <p>Upload your Family Details Document</p>
                                <button type="button" class="btn document-upload-button d-block mx-auto" onclick="document.getElementById('family_details_file').click();">
                                    Select Document
                                </button>
                                {{ family_details_form.document_file(id="family_details_file", class="d-none", onchange="showFileName(this, 'family_details_filename')") }}
                                <p id="family_details_filename" class="mt-2 file-name"></p>
                            </div>
                            
                            <button type="submit" class="btn btn-info">Upload Document</button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
    
    <!-- Combined Document Actions Section -->
    <div class="card mt-4 mb-4">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">Combined Document Actions</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6 text-center mb-3 mb-md-0">
                    <div class="icon-box">
                        <i class="fas fa-file-pdf fa-3x text-danger mb-3"></i>
                        <h5>Combined PDF Preview</h5>
                        <p>Generate a PDF containing all your uploaded documents in a single file</p>
                        <a href="{{ url_for('generate_combined_pdf_preview') }}" class="btn btn-outline-danger">
                            <i class="fas fa-download mr-2"></i> Download Combined PDF
                        </a>
                    </div>
                </div>
                <div class="col-md-6 text-center">
                    <div class="icon-box">
                        <i class="fas fa-file-archive fa-3x text-secondary mb-3"></i>
                        <h5>Download All Documents</h5>
                        <p>Download all your uploaded documents as a ZIP archive</p>
                        <a href="{{ url_for('download_documents_zip') }}" class="btn btn-outline-secondary">
                            <i class="fas fa-download mr-2"></i> Download ZIP Archive
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block dashboard_js %}
<script>
    function showFileName(input, elementId) {
        const fileName = input.files[0].name;
        document.getElementById(elementId).textContent = fileName;
        
        // If this is a form with auto-submit, don't submit immediately on selection
        if (!input.form.classList.contains('upload-form')) {
            input.form.submit();
        }
    }
</script>
{% endblock %}
